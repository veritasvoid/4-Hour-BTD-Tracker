function renderInsiderTable() {
    const tbody = document.getElementById('insiderResultsBody');
    const emptyState = document.getElementById('insiderEmptyState');
    document.getElementById('insiderRowCount').textContent = `${insiderData.length} rows`;

    if (insiderData.length === 0) {
        tbody.innerHTML = '';
        emptyState.style.display = 'block';
        return;
    }

    emptyState.style.display = 'none';

    tbody.innerHTML = insiderData.map((item, index) => {
        const change = item.alertPrice && item.currentPrice
            ? ((item.currentPrice - item.alertPrice) / item.alertPrice) * 100
            : null;
        const changeClass = change !== null
            ? (change >= 0 ? 'change-positive' : 'change-negative')
            : '';
        const changeText = change !== null
            ? `${change >= 0 ? '+' : ''}${change.toFixed(2)}%`
            : '—';

        let currentPriceClass = '';
        if (item.currentPrice && item.alertPrice) {
            currentPriceClass = item.currentPrice >= item.alertPrice
                ? 'price-positive'
                : 'price-negative';
        }

        const isExpanded = currentExpandedInsiderId === item.id;

        // No background-color on insider rows anymore
        let html = `
            <tr>
                <td>${index + 1}</td>
                <td>${item.date}</td>
                <td class="ticker-cell ${isExpanded ? 'expanded' : ''}" onclick="toggleInsiderCompanyInfo(${item.id})">${item.ticker}</td>
                <td>${item.companyName}</td>
                <td class="news-cell">${item.news}</td>
                <td>${item.insider ? `<span class="insider-badge">${item.insider}</span>` : '—'}</td>
                <td class="amount-cell">${item.amount || '—'}</td>
                <td class="price-cell">${item.alertPrice ? '$' + item.alertPrice.toFixed(2) : '—'}</td>
                <td class="price-cell ${currentPriceClass}">${item.currentPrice ? '$' + item.currentPrice.toFixed(2) : '<span class="loading"></span>'}</td>
                <td class="${changeClass}">${changeText}</td>
            </tr>
        `;

        if (isExpanded) {
            html += `
                <tr class="company-info-row">
                    <td colspan="10">
                        <div class="company-info-content">
                            ${item.companyInfo
                                ? renderInsiderCompanyInfo(item)
                                : '<div class="company-info-loading"><span class="loading"></span> Loading AI analysis...</div>'}
                        </div>
                    </td>
                </tr>
            `;
        }

        return html;
    }).join('');
}
